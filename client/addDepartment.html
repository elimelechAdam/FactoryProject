<!DOCTYPE html>
<html>
  <head>
    <title>Departments</title>
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <script src="utilis.js" defer></script>
    <script>
      //need to make utilis and make global function

      async function addDepartment() {
        try{
          let name = document.getElementById("name").value;
          let manager = +document.getElementById("manager").value;
          let status = await addAction();

          let departmentObj = {
            Name: name,
            Manager: manager,
          };

          let fetchParams = {
            method: "POST",
            body: JSON.stringify(departmentObj),
            headers: { "Content-Type": "application/json" },
          };
          if (!status == 0) {
            
            await fetch("https://localhost:44300/api/department/",fetchParams);
            alert("Added - you are taken to the department page.");
            console.log("Added");
            window.location.href = `departments.html`;
          } else {
            alert("No actions left.");
            console.log(`Error Status : ${status}`);
          }
        }
        catch(err){
          console.log(err);
        }
    }
    </script>
    <style></style>
  </head>
  <body onload="setWelcome()">
    <div class="d-flex justify-content-between">
      <h4>
        <span
          class="badge badge-pill badge-primary form-inline my-2 my-lg-0"
          id="userWelcome"
          >Welcome</span
        ><br />

      </h4>
      <ul class="nav">
        <li class="nav-item">
          <a class="nav-link active" href="employees.html">Employees</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="departments.html">Departments</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="shifts.html">Shifts</a>
        </li>
        <li class="nav-item">
          <a
            class="badge badge-pill badge-danger form-inline my-2 my-lg-0"
            href="logout.html"
            >Logout</a
          >
        </li>
      </ul>
    </div>
    <br />
    <div class="container centered-form" style="width: 20%">
        <div class="card">
          <div class="card-body">
            <h3 class="card-title" style="text-align: center">Add department</h3>
            <form>
              <div class="form-group">
                <input
                  type="text"
                  class="form-control"
                  id="name"
                  placeholder="Name"
                />
              </div>
              <div class="form-group">
                <input
                  type="text"
                  class="form-control"
                  id="manager"
                  placeholder="Manager"
                />
              </div>


              <button type="input" class="btn btn-primary" onclick="event.preventDefault();addDepartment()">add</button>
            </form>


            <h5><span id="addMsg"></span></h5>

          </div>
        </div>
      </div>
      </table>
    </div>

    <!-- Bootstrap JS -  Makes error 1.6.23 - Console error -->
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script> -->
  </body>
</html>
